<!doctype html>

<html>
    <head>
        
        
        <title>Ease app</title>
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>


        <script>
            
            function getDatas(website, callback){    
                $.getJSON('ease/connection/'+website, function(data) {
                    callback(data);
                });
                
            }
            
            function sendEvent(){
                var website = document.getElementById("website").value;
                var user = document.getElementById("user").value;
                var passwd = document.getElementById("passwd").value;
                console.log("sending event to " + website+ " for user "+user);
                getDatas(website,function(datas){
                    var event = new CustomEvent("NewConnection",{ //dispatch an Event to warn the plugin it has to connect to the website
                    'detail':{
                        'infos':{
                            "user":user,
                            "pass":passwd
                        },
                        
                        "connection":datas
                    }
                    });
                    document.dispatchEvent(event);
                    console.log("event sent");
            });
            }
            
            
        </script>
        
    </head>
    <body>
        <p>Welcome to Ease !</p>
        <div>
            Website: <input id="website" type="text" name="website"><br>
            Log In: <input id="user" type="text" name="user"><br>
            Password: <input id="passwd" type="password" name="pssswd"><br>
            <button id="button" onclick="sendEvent()"> CONNEXION </button>
        </div>
        

    </body>
</html>
